import{w}from"./with-props-Bz5eeop3.js";import{a as n,q as j,n as e,t as y}from"./chunk-XJI4KG32-C1znyQtU.js";import{u as b}from"./request-Dv1uV-Bk.js";const v=w(function(){const[a,c]=n.useState([]),[l,p]=n.useState(!0),[r,i]=n.useState(null),d=b();n.useEffect(()=>{(async()=>{try{p(!0);const s=await d("/api/topics/",{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error(`API请求失败: ${s.status}`);const o=await s.json();c(o),i(null)}catch(s){console.error("获取主题失败:",s),i("获取主题列表时出错，请稍后再试")}finally{p(!1)}})()},[]);const h=j(),u=()=>{h("/newTopic")},m=t=>{h(`/newTopic/${t}`)},x=async t=>{if(window.confirm("您确定要删除这个主题吗？"))try{const o=await d(`/api/topics/${t}/`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error(`删除失败: ${o.status}`);c(a.filter(f=>f.id!==t))}catch(o){console.error("删除主题失败:",o),i("删除主题时出错，请稍后再试")}};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"学习主题列表"}),e.jsx("button",{className:"bg-blue-500 text-white font-semibold py-2 px-4 rounded hover:bg-blue-600",onClick:u,children:"创建新主题"})]}),l&&e.jsx("p",{className:"text-gray-500",children:"加载中..."}),r&&e.jsx("p",{className:"text-red-500",children:r}),!l&&!r&&(a.length>0?e.jsx("nav",{children:e.jsx("ul",{className:"list-disc pl-5",children:a.map(t=>e.jsxs("li",{className:"mb-2 relative group",children:[e.jsx(y,{to:`/topics/${t.id}`,className:"text-blue-500 hover:underline",children:t.text}),e.jsx("button",{className:"absolute right-16 bg-yellow-500 text-white p-1 rounded opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>m(t.id),children:"编辑"}),e.jsx("button",{className:"absolute right-0 bg-red-500 text-white p-1 rounded opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>x(t.id),children:"删除"})]},t.id))})}):e.jsx("p",{className:"text-gray-500",children:"没有找到学习主题。"}))]})});export{v as default};
